cmake_minimum_required(VERSION 3.16)
project(SortingAlgorithmsParallelization LANGUAGES C CXX)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# --- OpenMP ---
find_package(OpenMP REQUIRED)
if(OpenMP_CXX_FOUND)
    message(STATUS "âœ… OpenMP found!")
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -fopenmp")
endif()

# --- SIMD + Optimizacija ---
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -O3 -march=native -mavx2 -mavx512f")

include_directories(include)

# --- Build executable groups ---
file(GLOB SEQ_NAIVE_SRC "sequential_naive/*.cpp")
foreach(src_file ${SEQ_NAIVE_SRC})
    get_filename_component(exec_name ${src_file} NAME_WE)
    add_executable(sequential_naive_${exec_name} ${src_file})
endforeach()

file(GLOB SEQ_OPT_SRC "sequential_optimized/*.cpp")
foreach(src_file ${SEQ_OPT_SRC})
    get_filename_component(exec_name ${src_file} NAME_WE)
    add_executable(sequential_optimized_${exec_name} ${src_file})
endforeach()

file(GLOB CPU_SRC "parallel_cpu/*.cpp")
foreach(src_file ${CPU_SRC})
    get_filename_component(exec_name ${src_file} NAME_WE)
    add_executable(parallel_cpu_${exec_name} ${src_file})
    if(OpenMP_CXX_FOUND)
        target_link_libraries(parallel_cpu_${exec_name} OpenMP::OpenMP_CXX)
    endif()
endforeach()